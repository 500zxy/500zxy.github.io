!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(n="undefined"!=typeof globalThis?globalThis:n||self).jsApi=e()}(this,function(){"use strict";var n=navigator.userAgent,e={versions:{trident:-1<n.indexOf("Trident"),presto:-1<n.indexOf("Presto"),webKit:-1<n.indexOf("AppleWebKit"),gecko:-1<n.indexOf("Gecko")&&-1===n.indexOf("KHTML"),mobile:!!n.match(/AppleWebKit.*Mobile.*/),ios:!!n.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:-1<n.indexOf("Android")||-1<n.indexOf("Linux"),iPhone:-1<n.indexOf("iPhone"),iPad:-1<n.indexOf("iPad"),webApp:-1===n.indexOf("Safari")},language:(navigator.browserLanguage||navigator.language).toLowerCase()};function o(){var n=window.sessionStorage.getItem("jsSession"),o={msg:"",status:""};return new Promise(function(t,i){void 0!==n&&""!==n&&null!==n||(o.status=-1,o.msg="未登录",i(o)),window.WebViewJavascriptBridge.callHandler("authCheckApp",{session:n},function(n){var e=n;0===(e="string"==typeof n?JSON.parse(n):e).status?(o.status=0,o.msg="认证成功",t(o)):(o.stutas=e.status,o.msg=e.msg,i(o))})})}function t(n,i){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler(n,i,function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})}var i={apiAddSchedule:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("apiAddSchedule",{scheduleName:n.scheduleName,startDate:n.startDate,endDate:n.endDate,address:n.address,remindDate:n.remindDate,describe:n.describe},function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},apiAuthUser:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("apiAuthUser",{userName:n.userName,userIDNumber:n.userIDNumber},function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},login:function(n){return new Promise(function(e,t){!function(n){if(window.WebViewJavascriptBridge)return n(window.WebViewJavascriptBridge);if(window.WVJBCallbacks)return window.WVJBCallbacks.push(n);window.WVJBCallbacks=[n];var e=document.createElement("iframe");e.style.display="none",e.src="wvjbscheme://__BRIDGE_LOADED__",document.documentElement.appendChild(e),setTimeout(function(){document.documentElement.removeChild(e)},0)}(function(){window.WebViewJavascriptBridge.callHandler("login",{appKey:n.appKey},function(n){0===(n="string"==typeof n?JSON.parse(n):n).status?(sessionStorage.setItem("jsSession",n.result.session),e(n)):t(n)})})})},getGPS:function(){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("getGPS",null,function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},getUserInfo:function(){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("getUserInfor",null,function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},scanQRcode:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("scanQRcode",n,function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},scanQRdata:function(){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("scanQRcode",obj,function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},alert:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("alert",{message:n.message,title:n.title,btnName:n.btnName},function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},confirm:function(i){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("confirm",{message:i.message,title:i.title,btnName:i.btnName},function(n){"string"==typeof n&&(n=JSON.parse(n)),e(n);n=n.result.clickIndex;i.btn[n]()})}).catch(function(n){t(n)})})},singleShake:function(){o().then(function(){window.WebViewJavascriptBridge.callHandler("singleShake",{},function(n){})})},showProgress:function(){o().then(function(){window.WebViewJavascriptBridge.callHandler("showProgress",{},function(n){})})},hiddenProgress:function(){o().then(function(){window.WebViewJavascriptBridge.callHandler("hiddenProgress",{},function(n){})})},hiddenNavigation:function(){o().then(function(){window.WebViewJavascriptBridge.callHandler("hiddenNavigation",{},function(n){})})},showNavigation:function(){o().then(function(){window.WebViewJavascriptBridge.callHandler("showNavigation",{},function(n){})})},closeWebView:function(){o().then(function(){window.WebViewJavascriptBridge.callHandler("closeWebView",{},function(n){})}).catch(function(n){Promise.reject(n)})},webViewReset:function(){o().then(function(){window.WebViewJavascriptBridge.callHandler("webViewReset",{},function(n){})})},modifyNavigationTitle:function(n){o().then(function(){window.WebViewJavascriptBridge.callHandler("webViewReset",{title:n.title},function(n){})})},createTribe:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("createTribe",{tribeName:n.tribeName,tribeNotice:n.tribeNotice},function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},joinToTribe:function(n){return t("joinToTribe",n)},openTribe:function(n){return t("openTribe",n)},noticeBroad:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("noticeBroad",{noticeName:n.noticeName},function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},openPerson:function(n){return t("openPerson",n)},openPersonWithKey:function(n){return t("openPersonWithKey",n)},shakeOneShake:function(){return new Promise(function(t){window.WebViewJavascriptBridge.registerHandler("shakeOneShake",function(n,e){e({status:0}),t(n)})})},saveImage:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("saveImage",{imageUrl:n.imageUrl},function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},needBackAction:function(){return new Promise(function(e){window.WebViewJavascriptBridge.callHandler("needBackAction",{},function(n){e(n)})})},giveBackAction:function(){return new Promise(function(t){window.WebViewJavascriptBridge.registerHandler("giveBackAction",function(n,e){e({status:0}),t(n)})})},makePhoneCall:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("makePhoneCall",{tel:n.tel},function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},requestMethod:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("requestMethod",{method:n.method,requestData:n.requestData,requestUrl:n.requestUrl},function(n){"string"==typeof n&&(n=JSON.parse(n)),e(n)})}).catch(function(n){t(n)})})},openNewWebView:function(n){o().then(function(){window.WebViewJavascriptBridge.callHandler("openNewWebView",{url:n.url,title:n.title,hiddenNavigation:n.hiddenNavigation},function(n){})})},cutWebView:function(){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("cutWebView",{},function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},phoneInfo:function(){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("phoneInfo",{},function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},apiDeviceGetAddress:function(){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("apiDeviceGetAddress",{},function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},perfectPhone:function(n){return t("perfectPhone",n)},getSysBrowser:function(n){return t("getSysBrowser",n)},getChildrenInfo:function(){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("getChildrenInfo",{},function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},zfbPay:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("zfbPay",{payApply:n.payApply},function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},cmxxsfzzdy:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("cmxxsfzzdy",{url:n.url,type:n.type},function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},wxPay:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("wxPay",{payApply:n.payApply},function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},getEduUserInfo:function(){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("apiGetEDUUserInfo",null,function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},apiGetRecording:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("apiGetRecording",{duration:n.duration},function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},terminalPrint:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("apiPrinting",n,function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},terminalDeviceInfo:function(){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("apiGetDeviceInfo",null,function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},terminalSaveUserInfo:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("apiSaveUserInfo",n,function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},terminalScanQr:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("apiScanQr",n,function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},apiUploadingPicture:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("apiUploadingPicture",n,function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},setScreenBrightness:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("apiSetScreenBrightness",n,function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})},bluetoothUnlock:function(n){return new Promise(function(e,t){o().then(function(){window.WebViewJavascriptBridge.callHandler("apiBluetoothUnlock",n,function(n){(0===(n="string"==typeof n?JSON.parse(n):n).status?e:t)(n)})}).catch(function(n){t(n)})})}};return new function n(){!function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.browser=e,Object.assign(this,i)}});

